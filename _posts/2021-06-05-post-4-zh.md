---
layout: post
title: "K线形态有用吗？——『红三兵』的回测"
date: 2021-06-05
comments: true
issue_number: 4
tags: [zh, finance, investment]
categories: [zh, finance]
---

> ***本文仅为个人研究记录，不构成任何投资建议。***

***问题：*** 基于K线形态的买股策略能赚钱吗？  
***结论：*** 不能。

<br>

---
<br>

## 什么是『红三兵』？

K线是**记录**股票价格的一种图线，用一根柱子概括了一天（或月、年、分钟）的开盘价、收盘价、最高价、最低价。

> 图1. K线图示例。  
> 本文作图用**白色**表示股价**上涨**，**黑色**表示股价**下跌**。
> <center><img src="/assets/post-4/candlestick-plot-explanation.png" alt="K线图样例" width="600"/></center>  

『K线形态』是技术分析研究的一个分支，常被价值投资者嗤之以鼻，但受到不少股民的追捧。该理论认为股票的**K线形态**能对后续价格走势提供**有效预测**。『红三兵』是其中常用的形态之一，被认为是股价后续会上涨的前兆。

（简化版本）『红三兵』指的是：连续3天
1. 每天收盘价大于开盘价，即当天股价上涨。
2. 每天的收盘价高于前一天的收盘价，即3根日K线排列向上。

> 图1. 简化版本的『红三兵』示例。  
> 图中蓝色框选部分就是一个『红三兵』形态。  
> 『红三兵』得名于：在A股，红色表示上涨，其形态就是3个向上的红色柱子。  
> 由于本文的作图用白色表示上涨，所以其实应该叫『白三兵』:P
> <center><img src="/assets/post-4/3_ascending_candles.png" alt="『红三兵』示例" width="800"/></center>  

这里之所以说是“简化版本”，因为『红三兵』形态可以加上许多限制，比如：结合成交量情况、每根柱子的长度限制、两根柱子间的涨幅限制……这里先不考虑这些，做个简单的评估，如果读者有兴趣可以在评论区提出建议。

<br>

---
<br>

## 回测实验设定

实验都基于以下设定，如果你对此有建议或发现什么问题，欢迎在评论区给我反馈。

1. **初始资金10万**。
2. 在`T`日出现『红三兵』形态后，以`T+1`的**开盘价全仓买入**，以`T+2`的**开盘价全部卖出**。（“老夫买股从来都是一把梭”）
3. 假设**小资金对股价走势没有影响**。对于大市值股票成立，但小市值股票可能就不成立了。
4. 假设**交易费率为0**。因为是日线级别的交易，次数不多。（主要算起来比较麻烦，印花税、过户费、券商佣金……）
5. 使用**前复权数据**。由于只是看单个股票的K线形态，应该不存在引入未来函数的问题。

我还做了几个基准策略做对比（都是以开盘价，在`T+1`日全仓买入，并在`T+2`日全部卖出）：
1. **忘记密码型选手**。一开始全仓买入后，再也没有交易，直到最后一天想起密码后卖出。
2. **激进的随机傻瓜**。完全不看任何指标，每次以50%的概率随机决定买股票。
3. **保守的随机傻瓜**。完全不看任何指标，每次以5%的概率随机决定买股票。

<br>

---
<br>

## 回测实验结果

挑选市值较大的中国平安（601318.SH）和万科A（000002.SZ）作为研究对象，下表是回测实验的结果。

> 表1. 中国平安上的回测收益率。

| 年份 \ 策略 | 忘记密码型选手   | 红三兵   | 激进的随机傻瓜   | 保守的随机傻瓜   |
|------|------------------|----------|------------------|------------------|
| 2014 | <span style="color:red">**78.94%**</span>           | 4.62%    | 10.15%           | -2.82%           |
| 2015 | -6.68%           | <span style="color:red">**0.37%**</span>    | -1.27%           | -0.64%           |
| 2016 | 0.06%            | -0.14%   | 0.57%            | <span style="color:red">**1.21%**</span>            |
| 2017 | <span style="color:red">**102.4%**</span>           | 1.47%    | -0.84%           | 0.2%             |
| 2018 | -15.69%          | -2.2%    | -2.15%           | <span style="color:red">**0.18%**</span>            |
| 2019 | <span style="color:red">**56.18%**</span>           | -0.9%    | -0.46%           | -0.7%            |
| 2020 | <span style="color:red">**2.42%**</span>            | -0.32%   | -0.18%           | 1.53%            |
| 2021 | -15.76%          | -2.04%   | <span style="color:red">**0.39%**</span>            | -0.25%           |

> 表2. 万科A上的回测收益率。

| 年份 \ 策略 | 忘记密码型选手   | 红三兵   | 激进的随机傻瓜   | 保守的随机傻瓜   |
|------|------------------|----------|------------------|------------------|
| 2014 | <span style="color:red">**66.04%**</span>           | 1.2%     | 1.2%             | 4.62%            |
| 2015 | <span style="color:red">**60.38%**</span>           | -1.2%    | 2.4%             | 0.35%            |
| 2016 | -1.05%           | 0.3%     | -1.91%           | <span style="color:red">**0.49%**</span>            |
| 2017 | <span style="color:red">**54.34%**</span>           | 0.19%    | 0.61%            | -0.48%           |
| 2018 | -21.4%           | -1.0%    | -4.87%           | <span style="color:red">**2.38%**</span>            |
| 2019 | <span style="color:red">**36.64%**</span>           | -1.25%   | 1.05%            | 3.11%            |
| 2020 | -10.35%          | -0.32%   | <span style="color:red">**1.33%**</span>            | -1.01%           |
| 2021 | -5.04%           | 0.43%    | <span style="color:red">**0.54%**</span>            | -2.3%            |

不难看出，『红三兵』形态并没有明显的优势，甚至一些年份的表现不如“随便乱买”（当然我并不推荐这样做:P）。

也许使用一个强化版本的『红三兵』策略，比如放宽持有时长、结合成交量、均线突破等指标，能比当前版本做得更好。但大概率不会比一个“忘记密码”的股民表现更好。从表中也能看出，以合适的估值买入好公司并持有，能带来更大的收益。

<br>

---
<br>

欢迎在评论区给我留言～
